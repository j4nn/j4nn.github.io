<!DOCTYPE html>
<html>
<head>
<title>j4nn sw development</title>
<meta name="keywords" content="android pie exploit, TrustZone exploit, verified boot bypass, locked bootloader, qsee exploit, bootloader exploit, ABL exploit">
</head>
<body>
<h1>Linux Software Development Projects by j4nn</h1>

<h2>Xperia ABL fastboot Exploit via CVE-2021-1931</h2>
The <code>xperable</code> fastboot exploit supporting Yoshino (Snapdragon 835) and Tama (Snapdragon SDM845) platforms allows bootloader unlock and <b>re-lock</b> freely even with phones with rooting not allowed.<br/>
Supported phones are Sony Xperia XZ1c/XZ1/XZp and XZ2/XZ2c/XZ2p/XZ3 with many region specific variants.<br/>
<br/>
With yoshino it is possible to "<code>fastboot boot twrp.img</code>" with locked bootloader and working userdata decryption. Many other features supported.<br/>
<br/>
<a href="https://github.com/j4nn/xperable">https://github.com/j4nn/xperable</a><br/>
xperable xda <a href="https://xdaforums.com/t/xz1c-xz1-xzp-xperable-xperia-abl-fastboot-exploit-cve-2021-1931.4771931/">thread for yoshino</a>, xperable xda <a href="https://xdaforums.com/t/xz2-xz2c-xz2p-xz3-xperable-xperia-abl-fastboot-exploit-cve-2021-1931.4771932/">thread for tama</a><br/>
video demonstrating xperable exploit use <a href="https://youtu.be/8H2p7CZKcfo">with XZ1c</a> and <a href="https://youtu.be/5KLfDHFyn18">with XZ2</a><br/>

<h2>TWRP for Sony Xperia XZ2/XZ2c/XZ2p/XZ3</h2>
twrp-3.7.1_12 for Sony Tama (SDM845) platform devices, supporting userdata decryption of recent android versions.<br/>
<br/>
<a href="https://xdaforums.com/t/recovery-twrp-3-7-1_12-xz2-xz2c-xz2p-xz3.4772176/">xda thread</a><br/>
<a href="https://github.com/j4nn/android_device_sony_tama">https://github.com/j4nn/android_device_sony_tama</a><br/>
<a href="https://sourceforge.net/projects/tama-testbuilds/">https://sourceforge.net/projects/tama-testbuilds/</a><br/>

<h2>TWRP for Sony Xperia XZ1c/XZ1</h2>
twrp-3.7.1_12 for lilac and poplar_dsds devices.<br/>
This is a fork of <a href="https://github.com/whatawurst/">whatawurst</a>'s twrp, adding a fix for userdata decryption with recent android versions.<br/>
Thank you and credits to <a href="https://github.com/derfelot">@derf elot</a> and <a href="https://github.com/cryptomilk">@modpunk</a> at xda.<br/>
<br/>
<a href="https://xdaforums.com/t/rom-lineageos-21-0-unofficial-1-1-2024-06-16.4658694/post-90209859">xda forums post</a><br/>
<a href="https://github.com/whatawurst/android_device_sony_lilac/pull/64">https://github.com/whatawurst/android_device_sony_lilac/pull/64</a><br/>
<a href="https://github.com/j4nn/android_device_sony_lilac/tree/android-12.1">https://github.com/j4nn/android_device_sony_lilac/tree/android-12.1</a><br/>
<a href="https://sourceforge.net/projects/yoshino-testbuilds">https://sourceforge.net/projects/yoshino-testbuilds</a><br/>

<h2>Temp Root Exploit via CVE-2020-0041 Including Temporal Magisk Setup</h2>
<ul>
<li>Sony Xperia XZ2/XZ2c/XZ2p/XZ3: <a href="https://xdaforums.com/t/xz2-xz2c-xz2p-xz3-temp-root-exploit-via-cve-2020-0041-including-magisk-setup.4099131/">xda thread</a>, sources at <a href="https://github.com/j4nn/CVE-2020-0041/tree/tama-mroot">https://github.com/j4nn/CVE-2020-0041/tree/tama-mroot</a></li>
<li>Sony Xperia 1, Xperia 5: <a href="https://xdaforums.com/t/xperia-1-5-temp-root-exploit-via-cve-2020-0041-including-magisk-setup.4146103/">xda thread</a>, sources at <a href="https://github.com/j4nn/CVE-2020-0041/tree/x1x5-mroot">https://github.com/j4nn/CVE-2020-0041/tree/x1x5-mroot</a></li>
<li>LG V50/G8: <a href="https://xdaforums.com/t/lg-v50-temp-root-exploit-via-cve-2020-0041-including-magisk-setup.4098077/">LG V50 xda thread</a>, <a href="https://xdaforums.com/t/lg-g8-temp-root-exploit-via-cve-2020-0041-including-magisk-setup.4100333/">LG G8 xda thread</a>, sources at <a href="https://github.com/j4nn/CVE-2020-0041/tree/v50g8-mroot">https://github.com/j4nn/CVE-2020-0041/tree/v50g8-mroot</a></li>
</ul>

<h2>Temp Root Exploit via CVE-2019-2215 for Sony Xperia XZ1c/XZ1/XZp</h2>
Thread on xda with the exploit and scripts to setup temporal magisk:<br/>
<a href="https://xdaforums.com/t/xz1c-xz1-xzp-temp-root-exploit-via-cve-2019-2215-including-magisk-setup-locked-bl.4046641/">[XZ1c/XZ1/XZp] temp root exploit via CVE-2019-2215 including magisk setup [Locked BL]</a><br/>
<br/>
Source code for the exploit (bindershell) is available here:<br/>
<a href="https://github.com/j4nn/renoshell/tree/CVE-2019-2215">https://github.com/j4nn/renoshell/tree/CVE-2019-2215</a><br/>
<br/>

<h2>Permanently rooting Android PIE without bootloader unlock - Xperia XZ1c</h2>
<a href="https://forum.xda-developers.com/general/security/android-pie-verifiedboot-bypass-sony-t4005711">Work in progress at xda</a> - preview recordings of features implemented for xz1c:
<ol>
<li><a href="https://youtu.be/TAhSNjxZfhc">LOS16 with locked BL</a><br/>
short preview of Lineage OS 16.0 booting instead of stock fw with still locked bootloader including magisk root<br/>
<a href="https://forum.xda-developers.com/showpost.php?p=80646863&postcount=1354">announcing post on xda</a>
</li>
<li><a href="https://youtu.be/0IMee3Ycr18">verified boot bypass</a>:<br/>
- fastboot-ing twrp<br/>
- permanently flashing twrp as recovery<br/>
- permanently rooting stock fw with magisk without unlocking bootloader</li>
<li><a href="https://youtu.be/lbPqi7mszjk">LOS16 from sd card</a><br/>
installing LOS16 as an alternate OS to sdcard for multiboot via recovery</li>
<li><a href="https://youtu.be/XhyurBOwefY">LOS16 instead of stock fw with locked BL</a><br/>
dual booting two LOS16 installations, one replacing stock fw, the other from sd card<br/>
replacing the 2nd LOS16 with twrp recovery being happy with just one LOS16 replacing stock fw with still locked bootloader</li>
</ol>
Playlist of all the above available <a href="https://www.youtube.com/playlist?list=PLIdPBn2_BMhl7_mUSiYqnIVm7FSdkXH2x">here</a>.<br/>
<br/>
<details><summary><a>more details about the vulnerability</a></summary>
<h4>Vulnerability impact</h4>
This could be used to inject any software into a xperia phone, like remote root backdoor or some eavesdropping spyware.<br/>
An exploit may be implemented in a way that it could survive full firmware re-flash from computer or even system fota upgrade, including factory reset, making it very powerful.<br/>
If used with another temp (or remote) root exploit, this vulnerability may be leveraged without user noticing anything, so an attacker may do persistent changes even when bootloader is still locked with verified boot active.<br/>

<h4>Vulnerability scope</h4>
The proof of concept exploit is working with sony xperia xz1 compact phone.<br/>
It can be extended to support entire range of xperia phones running YOSHINO platform (qualcomm snapdragon 835) - XZ Premium, XZ1, XZ1 Compact (any of single/dual sim variants), including those that do not allow bootloader unlock as that is not needed.<br/>
First stage of the exploit has also been adapted for SONY XPERIA XZ2, as documented <a href="https://forum.xda-developers.com/showpost.php?p=80414661&postcount=1176">here</a> and in following posts. That means the exploit could be extended to support entire TAMA platform, i.e. sony xperia XZ2/XZ3 (Compact/Dual/Premium) phones.<br/>
There is a chance that the exploit could be adapted to any recent xperia phone released since yoshino platform. It has not been checked/proved either way though.<br/>

<h4>What to do next</h4>
I am not sure if the exploit should be publicly released to allow rooting without bootloader unlock or if this should go the responsible disclosure way, considering the misuse risks.
<br/>
<br/>
Even though this exploit is very powerful, my ultimate goal is TrustZone code execution hopefully allowing to inject custom verified boot keys and bootloader re-lock.<br/>
<U>Unfortunately I can spend less and less time working on this stuff, so I would appreciate help from other developers, particularly experienced with reverse engineering to help me find a hole to get into TrustZone / Qualcomm Secure Execution Environment (QSEE).</U><br/>
I have already some ideas for very promising TZ attack vectors.<br/>
<b><u>Please contact me if you would like to help me with TrustZone exploit development.<br/>
Thank you.</u></b>
<br/>
<br/>
<a href="https://github.com/j4nn/">https://github.com/j4nn/</a><br/>
<a href="https://forum.xda-developers.com/member.php?u=4418980">xda-developers profile</a>

</details>
<br/>
<h2>Tools to Backup Trim Area of Sony Xperia XZ1c/XZ1/XZp</h2>
<a href="https://forum.xda-developers.com/xperia-xz1-compact/development/devonly-exploits-temp-root-to-backup-t3795510">thread on xda with the tools development</a>
<br/>
The tools include my implementation of temp root exploit leveraging CVE-2017-7533.<br/>
<br/><details><summary><a>more details about the tools</a></summary>
<h4>About the tools</h4>
<ul>
<li><b>renosploit</b> - rename/notify exploit to get kernelspace read/write, uses multiple vulnerabilities to overcome kaslr, pxn and pan mitigations of android oreo</li>
<li><b>renotrap</b> - helper application (rename/notify temp root app)</li>
<li><b>renoshell</b> - get temp root shell by use of kernel space read/write primitives provided by renosploit</li>
<li><b>renoroot</b> - a shell script to be started from adb, it starts the above tools to get temp root shell</li>
</ul>
<h4>Acknowledgements to following xda users:</h4>
<ul>
<li><b>moofesr</b> - for testing initial kernel builds until proper build procedure had been found, special thanks for his patience when all tests resulted with bootloop</li>
<li><b>Raz0Rfail</b> and <b>moofesr</b> - for testing timing of rename/notify vulnerability with patched kernel</li>
<li><b>dosomder</b> - for his iovyroot</li>
<li><b>tramtrist</b> - for initial testing of TA backup, unlock and restore, special thanks for exposing to risk of loosing drm if it did not work</li>
<li><b>ThomasKing</b> (not a user on xda) - for his black hat ksma presentation</li>
<li><b>few other users in the thread on xda</b> - for some other cve possibilities and ideas</li>
</ul>
</details>

<h2>Donations</h2>
If you like my work, maybe consider supporting me with a donation here:<br/>
<br/>
<a href="https://j4nn.github.io/donate/">https://j4nn.github.io/donate/</a><br/>
<br/>
Thank you.<br/>
<br/>
<br/>
</body>
</html>
